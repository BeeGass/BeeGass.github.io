<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-06-27-kNN-Linear-Regression-Iris_Dataset.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<style>
  .klrid-images-style {
    display: flex;
    justify-content: center;
    align-content: stretch;
    flex-wrap: wrap;
    flex-direction: row;
    text-decoration: none !important;
  }
  .klrid-images-style img {
    margin-right: 5px;
    margin-left: 5px;
    margin-bottom: 10px;
  }
</style>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="kNN-&amp;-Linear-Regression-From-Scratch:-Iris-Dataset">kNN &amp; Linear Regression From Scratch: Iris Dataset<a class="anchor-link" href="#kNN-&amp;-Linear-Regression-From-Scratch:-Iris-Dataset"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><div class="flash">
    <svg class="octicon octicon-info" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>You can skip over the <strong>Introduction</strong> section. Jump to <strong><a href="#k-Nearest-Neighbours-From-Scratch">k-Nearest Neighbours implementation</a></strong>.
</div></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introduction">Introduction<a class="anchor-link" href="#Introduction"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Iris-Dataset">Iris Dataset<a class="anchor-link" href="#Iris-Dataset"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set">Iris dataset</a> is perhaps the best known database to be found in the pattern recognition literature.</p>
<p>The data set (available <a href="https://www.kaggle.com/uciml/iris">here</a>) consists of 50 samples from each of three species of Iris (Iris setosa, Iris virginica and Iris versicolor). Four features were measured from each sample: the length and the width of the sepals and petals, in centimeters. <strong>One class (specie) is linearly separable from the other 2; the latter are NOT linearly separable from each other, as seen in the plots below.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="klrid-images-style">

  <a><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_iris_dataset_001.png" title="Credit: https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html" style="height:300px" /></a>
  <a><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_iris_dataset_002.png" title="Credit: https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html" style="height:300px" /></a>

</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="k-Nearest-Neighbours-Algorithm">k-Nearest Neighbours Algorithm<a class="anchor-link" href="#k-Nearest-Neighbours-Algorithm"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm">k-Nearest Neighbours</a> algorithm is a non-parametric classification method used for classification and regression. In kNN classification, an object is assigned to the class most common among its <code>k</code> nearest neighbors (k is a positive integer, typically small). If <code>k = 1</code>, then the object is simply assigned to the class of that single nearest neighbor.</p>
<p><img src="https://i.ibb.co/VQMh7p4/knn.png" alt="k-Nearest Neighbours" title="Credit: http://res.cloudinary.com/dyd911kmh/image/upload/f_auto,q_auto:best/v1531424125/KNN_final1_ibdm8a.png" />&nbsp;</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><div class="flash">
    <svg class="octicon octicon-info" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>Jump to <strong><a href="#k-Nearest-Neighbours-From-Scratch">k-Nearest Neighbours implementation</a></strong>. The raw notebook file can be found <a href="https://github.com/Outsiders17711/Mein.Platz/blob/main/_notebooks/ipynb_data/kNN-Linear-Regression-Iris_Dataset.ipynb">here</a>.
</div>
<br /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Regression-Algorithm">Linear Regression Algorithm<a class="anchor-link" href="#Linear-Regression-Algorithm"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="https://en.wikipedia.org/wiki/Linear_regression">Linear Regression</a> algorithm is a linear approach to modelling the relationship between a scalar response <code>(y — dependent variables)</code> and one or more explanatory variables <code>(X — independent variables)</code>. Linear Regression fits a linear model with coefficients <code>w = (w1, w2, … , wn)</code> to minimize the residual sum of squares between the observed targets in the dataset, and the targets predicted by the linear approximation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a><img src="https://wiki.aalto.fi/download/attachments/155464048/linreg.png?version=1&amp;modificationDate=1565612055936&amp;api=v2" title="Credit: https://wiki.aalto.fi/display/ITSP/Linear+regression" style="height:300px;" /></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><div class="flash">
    <svg class="octicon octicon-info" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>Jump to <strong><a href="#Linear-Regression-From-Scratch">Linear Regression implementation</a></strong>.
</div></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># importing required libraries</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">statistics</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="c1"># set random seed</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="s1">&#39;iris dataset&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="k-Nearest-Neighbours-From-Scratch">k-Nearest Neighbours From Scratch<a class="anchor-link" href="#k-Nearest-Neighbours-From-Scratch"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The flowchart for implementing the kNN algorithm is shown below. Each step in the implementation will be wrapped in its own function for clarity.</p>
<p><img src="https://raw.githubusercontent.com/Outsiders17711/Mein.Platz/main/images/ipynb/knn_flowchart.png" alt="kNN Flowchart" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset is contained in a .csv file. We will implement a function <code>DataLoader</code> that calls several child functions to load and cleanup the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Read-Data">Read Data<a class="anchor-link" href="#Read-Data"> </a></h2><p>We start with the <code>_load_csv()</code> function which will use the python <a href="https://docs.python.org/3/library/csv.html">csv</a> module to read the file contents.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_load_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
		<span class="n">csv_reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv_reader</span> <span class="k">if</span> <span class="n">row</span><span class="p">]</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">_load_csv</span><span class="p">(</span><span class="s2">&quot;ipynb_data/IrisData.csv&quot;</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="mi">51</span><span class="p">:</span><span class="mi">53</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[&#39;5.1&#39;, &#39;3.5&#39;, &#39;1.4&#39;, &#39;0.2&#39;, &#39;Iris-setosa&#39;],
 [&#39;4.9&#39;, &#39;3.0&#39;, &#39;1.4&#39;, &#39;0.2&#39;, &#39;Iris-setosa&#39;],
 [&#39;6.4&#39;, &#39;3.2&#39;, &#39;4.5&#39;, &#39;1.5&#39;, &#39;Iris-versicolor&#39;],
 [&#39;6.9&#39;, &#39;3.1&#39;, &#39;4.9&#39;, &#39;1.5&#39;, &#39;Iris-versicolor&#39;],
 [&#39;6.2&#39;, &#39;3.4&#39;, &#39;5.4&#39;, &#39;2.3&#39;, &#39;Iris-virginica&#39;],
 [&#39;5.9&#39;, &#39;3.0&#39;, &#39;5.1&#39;, &#39;1.8&#39;, &#39;Iris-virginica&#39;]]</pre>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Clean-Data">Clean Data<a class="anchor-link" href="#Clean-Data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the csv reader loads the entire dataset as a list of list, each inner list containing <code>['sepal length', 'sepal width', 'petal length', 'petal width', 'species']</code>. We need to convert the four features from strings to floats. Let's create a function called <code>_clean_features()</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_clean_features</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="n">num_columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_columns</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">row</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

<span class="n">_clean_features</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="mi">51</span><span class="p">:</span><span class="mi">53</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[5.1, 3.5, 1.4, 0.2, &#39;Iris-setosa&#39;],
 [4.9, 3.0, 1.4, 0.2, &#39;Iris-setosa&#39;],
 [6.4, 3.2, 4.5, 1.5, &#39;Iris-versicolor&#39;],
 [6.9, 3.1, 4.9, 1.5, &#39;Iris-versicolor&#39;],
 [6.2, 3.4, 5.4, 2.3, &#39;Iris-virginica&#39;],
 [5.9, 3.0, 5.1, 1.8, &#39;Iris-virginica&#39;]]</pre>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Furthermore, in machine learning, it is preferred that all data be numeric (floats or integers). Thus, we need convert each unique class values (species) to integers and create a map between the integer values and the actual string values. We'll create a function called <code>_map_classes()</code> to acheive this.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_map_classes</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="n">class_mappings</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
        <span class="n">_specie</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">_specie</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">class_mappings</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">class_mappings</span><span class="p">[</span><span class="n">_specie</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_mappings</span><span class="p">)</span>
        <span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_mappings</span><span class="p">[</span><span class="n">_specie</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">class_mappings</span>

<span class="n">class_mappings</span> <span class="o">=</span> <span class="n">_map_classes</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">class_mappings</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="mi">51</span><span class="p">:</span><span class="mi">53</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;Iris-setosa&#39;: 0, &#39;Iris-versicolor&#39;: 1, &#39;Iris-virginica&#39;: 2}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[5.1, 3.5, 1.4, 0.2, 0],
 [4.9, 3.0, 1.4, 0.2, 0],
 [6.4, 3.2, 4.5, 1.5, 1],
 [6.9, 3.1, 4.9, 1.5, 1],
 [6.2, 3.4, 5.4, 2.3, 2],
 [5.9, 3.0, 5.1, 1.8, 2]]</pre>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><div class="flash">
    <svg class="octicon octicon-info" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>Now we have successfully cleaned out data and mapped the classes.
</div>
<br /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Normalize-Data">Normalize Data<a class="anchor-link" href="#Normalize-Data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In Machine Learning, two data scaling methods are most commonly discussed: <a href="&quot;https://en.wikipedia.org/wiki/Feature_scaling#Rescaling_(min-max_normalization">Normalization</a>") and <a href="&quot;https://en.wikipedia.org/wiki/Feature_scaling#Standardization_(Z-score_Normalization">Standardization</a>").</p>
<p>Normalization typically means rescaling the data into a range of [0,1]. Standardization typically means rescaling the data to have a mean of 0 and a standard deviation of 1 (unit variance). This <a href="https://towardsdatascience.com/normalization-vs-standardization-quantitative-analysis-a91e8a79cebf">article</a> analyzes the empirical results of applying different scaling methods on features in multiple experiments settings.</p>
<p>Distance-based algorithms (such as kNN) are affected by the scale of the variables and will give higher weightage to variables which have higher magnitude. To prevent the algorithm from being biased towards variables with higher magnitude, we can bring down all the variables to the same scale.</p>
<p>In our case, we will make use of Normalization (also known as min-max scaling) as it limits the range of the data and thus, a better option for kNN. Let's create a function called <code>_normalize_data()</code>, based on the Normalization formula shown below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a><img src="https://miro.medium.com/max/1400/1*GwcC80mDUyscDAWtwZSBdA.png" title="Credit: https://www.kdnuggets.com/2020/04/data-transformation-standardization-normalization.html" style="height:150px" /></a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_normalize_data</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="n">num_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_features</span><span class="p">):</span>
        <span class="n">column_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">]</span>
        <span class="n">column_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">column_values</span><span class="p">)</span>
        <span class="n">column_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">column_values</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
            <span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">column_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">column_max</span> <span class="o">-</span> <span class="n">column_min</span><span class="p">)</span>

<span class="n">_normalize_data</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="mi">51</span><span class="p">:</span><span class="mi">53</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[0.22222222222222213,
  0.6249999999999999,
  0.06779661016949151,
  0.04166666666666667,
  0],
 [0.1666666666666668,
  0.41666666666666663,
  0.06779661016949151,
  0.04166666666666667,
  0],
 [0.5833333333333334, 0.5, 0.5932203389830508, 0.5833333333333334, 1],
 [0.7222222222222222,
  0.4583333333333333,
  0.6610169491525424,
  0.5833333333333334,
  1],
 [0.5277777777777778,
  0.5833333333333333,
  0.7457627118644068,
  0.9166666666666666,
  2],
 [0.44444444444444453,
  0.41666666666666663,
  0.6949152542372881,
  0.7083333333333334,
  2]]</pre>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><div class="flash flash-warn">
    <svg class="octicon octicon-zap" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10.561 1.5a.016.016 0 00-.01.004L3.286 8.571A.25.25 0 003.462 9H6.75a.75.75 0 01.694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0012.538 7H9.25a.75.75 0 01-.683-1.06l2.008-4.418.003-.006a.02.02 0 00-.004-.009.02.02 0 00-.006-.006L10.56 1.5zM9.504.43a1.516 1.516 0 012.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 01-.871.354h-.302a1.25 1.25 0 01-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429z"></path></svg>
    <strong>Important: </strong>Now putting all the child functions together in the main function:
</div>

<br /></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">DataLoader</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">_load_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">_clean_features</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">class_mappings</span> <span class="o">=</span> <span class="n">_map_classes</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">_normalize_data</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">class_mappings</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we're done preparing the dataset for the classification using the kNN algorithm. Next, we implement the algorithm itself in a main function <code>kNN_Algorithm</code> that calls several child functions.</p>
<p><br /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Calculate-Euclidean-Distances">Calculate Euclidean Distances<a class="anchor-link" href="#Calculate-Euclidean-Distances"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to create a function that calculates the distance between two sets of data features. There are different distance formulas available but the <a href="https://en.wikipedia.org/wiki/Euclidean_distance">Euclidean distance</a> is most commonly used for kNN classification problems.</p>
<p>In mathematics, the Euclidean distance between two points in Euclidean space is the length of a line segment between the two points. The formula is shown below and is implemented with the <code>_euclidean_distance()</code> function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://aws1.discourse-cdn.com/codecademy/original/5X/e/2/9/6/e296139537a35d53394033117a05f12a401d4c42.png" alt="Euclidean Distance Formula" title="Credit: https://discuss.codecademy.com/t/faq-distance-formula-euclidean-distance/374303" /></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_euclidean_distance</span><span class="p">(</span><span class="n">row1</span><span class="p">,</span> <span class="n">row2</span><span class="p">):</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">num_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">row1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_features</span><span class="p">):</span>
        <span class="n">distance</span> <span class="o">+=</span> <span class="p">(</span><span class="n">row1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">row2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

<span class="p">(</span>
    <span class="n">_euclidean_distance</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="c1"># class 0 VS class 0</span>
    <span class="n">_euclidean_distance</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">51</span><span class="p">]),</span> <span class="c1"># class 0 VS class 1</span>
    <span class="n">_euclidean_distance</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># class 0 VS class 2</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.21561353744805575, 0.8458718030210156, 0.9646282869629299)</pre>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get-k-Nearest-Neighbours">Get k Nearest Neighbours<a class="anchor-link" href="#Get-k-Nearest-Neighbours"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we need to get the k nearest neighbours of a given (test) row (set of features) amongst a larger sample of (training) rows (sets of features). What we do is simply calculate the distances between the test row and all the training rows to get the <code>k</code> training rows with the smallest Euclidean distances. Let's create a function <code>get_k_neighbours()</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_get_k_neighbours</span><span class="p">(</span><span class="n">test_row</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">num_neighbours</span><span class="p">):</span>
    <span class="n">test_train_distances</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">train_row</span> <span class="ow">in</span> <span class="n">train_data</span><span class="p">:</span>
        <span class="n">_test_train_distance</span> <span class="o">=</span> <span class="n">_euclidean_distance</span><span class="p">(</span><span class="n">test_row</span><span class="p">,</span> <span class="n">train_row</span><span class="p">)</span>
        <span class="n">test_train_distances</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">train_row</span><span class="p">,</span> <span class="n">_test_train_distance</span><span class="p">])</span>

    <span class="n">test_train_distances</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">idx</span><span class="p">:</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">test_train_distances</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_neighbours</span><span class="p">)]</span>

<span class="n">_get_k_neighbours</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="mi">51</span><span class="p">:</span><span class="mi">53</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="n">num_neighbours</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[0.22222222222222213,
  0.6249999999999999,
  0.06779661016949151,
  0.04166666666666667,
  0],
 [0.1666666666666668,
  0.41666666666666663,
  0.06779661016949151,
  0.04166666666666667,
  0],
 [0.5833333333333334, 0.5, 0.5932203389830508, 0.5833333333333334, 1],
 [0.7222222222222222,
  0.4583333333333333,
  0.6610169491525424,
  0.5833333333333334,
  1],
 [0.44444444444444453,
  0.41666666666666663,
  0.6949152542372881,
  0.7083333333333334,
  2],
 [0.5277777777777778,
  0.5833333333333333,
  0.7457627118644068,
  0.9166666666666666,
  2]]</pre>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Predict-Classification">Predict Classification<a class="anchor-link" href="#Predict-Classification"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we predict the class of the test row based on the most occuring class amongst it's k nearest neighbours. We'll create a function called <code>_predict_classification()</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_predict_classification</span><span class="p">(</span><span class="n">test_row</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">num_neighbours</span><span class="p">):</span>
    <span class="n">nearest_neighbours</span> <span class="o">=</span>  <span class="n">_get_k_neighbours</span><span class="p">(</span><span class="n">test_row</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">num_neighbours</span><span class="p">)</span>
    <span class="n">nearest_classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">neighbour</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">neighbour</span> <span class="ow">in</span> <span class="n">nearest_neighbours</span><span class="p">]</span>
    <span class="n">predicted_class</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">nearest_classes</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">nearest_classes</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predicted_class</span>

<span class="n">_predict_classification</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="mi">51</span><span class="p">:</span><span class="mi">53</span><span class="p">]</span><span class="o">+</span><span class="n">dataset</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="n">num_neighbours</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><div class="flash flash-warn">
    <svg class="octicon octicon-zap" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10.561 1.5a.016.016 0 00-.01.004L3.286 8.571A.25.25 0 003.462 9H6.75a.75.75 0 01.694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0012.538 7H9.25a.75.75 0 01-.683-1.06l2.008-4.418.003-.006a.02.02 0 00-.004-.009.02.02 0 00-.006-.006L10.56 1.5zM9.504.43a1.516 1.516 0 012.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.25 1.25 0 01-.871.354h-.302a1.25 1.25 0 01-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429z"></path></svg>
    <strong>Important: </strong>Now putting all the child functions together in the main function:
</div>

<br /></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">kNN_Algorithm</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">num_neighbours</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">_predict_classification</span><span class="p">(</span><span class="n">test_row</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">num_neighbours</span><span class="p">)</span> <span class="k">for</span> <span class="n">test_row</span> <span class="ow">in</span> <span class="n">test_data</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we can go ahead and evaluate the performance of the algorithm against the dataset. The evaluation will be implemented using the function <code>Evaluate_kNN_Algorithm</code> which calls several child functions to split the dataset into test/train samples and calculate accuracies.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Split-Dataset-Into-Training-&amp;-Testing-Samples">Split Dataset Into Training &amp; Testing Samples<a class="anchor-link" href="#Split-Dataset-Into-Training-&amp;-Testing-Samples"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will try two popular methods for splitting the dataset in training and testing samples:</p>
<ul>
<li><em>Test/Train Split</em>: The dataset is shuffled and a percentage is used for training and the rest for testing. The algorithm is then trained on the training sample and it's performance evaluated using the testing sample. This is implemented in the <code>_test_train_split()</code> function.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a><img src="https://d1m75rqqgidzqn.cloudfront.net/wp-data/2020/07/15185319/blogs-15-7-2020-02-1024x565.jpg" title="Credit: https://www.analyticsvidhya.com/blog/2021/05/importance-of-cross-validation-are-evaluation-metrics-enough/" style="height:300px;" /></a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_test_train_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">test_ratio</span><span class="p">):</span>
    <span class="n">_dataset</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">_dataset</span><span class="p">)</span>

    <span class="n">split_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">*</span> <span class="n">test_ratio</span><span class="p">)</span>
    <span class="c1"># Training data</span>
    <span class="n">test_sample</span> <span class="o">=</span> <span class="n">_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">split_index</span><span class="p">]</span>
    <span class="c1">#Testing data</span>
    <span class="n">train_sample</span> <span class="o">=</span> <span class="n">_dataset</span><span class="p">[</span><span class="n">split_index</span><span class="p">:]</span>

    <span class="k">return</span> <span class="n">test_sample</span><span class="p">,</span> <span class="n">train_sample</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><em>Cross Validation Split</em>: The dataset is shuffled and split into k groups. The algorithm is then trained and evaluated k times and the performance summarized by taking the mean performance score. During each training and evaluation step, one of the k groups is used as the testing sample and the remaining groups as the training sample.  This is implemented in the <code>_cross_validation_split()</code> function.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a><img src="https://zitaoshen.rbind.io/project/machine_learning/machine-learning-101-cross-vaildation/featured.png" title="Credit: https://www.analyticsvidhya.com/blog/2021/05/importance-of-cross-validation-are-evaluation-metrics-enough/" style="height:300px;" /></a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_cross_validation_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">num_groups</span><span class="p">):</span>
    <span class="n">dataset_groups</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_dataset</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">group_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_dataset</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_groups</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_groups</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">group_size</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_dataset</span><span class="p">))</span>
            <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_dataset</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
        <span class="n">dataset_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dataset_groups</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Define-Accuracy-Metric">Define Accuracy Metric<a class="anchor-link" href="#Define-Accuracy-Metric"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we create a simple function <code>_get_accuracy()</code> that returns the percentage of the test classes correctly predicted by the algorithm.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_get_accuracy</span><span class="p">(</span><span class="n">test_sample</span><span class="p">,</span> <span class="n">algorithm_predictions</span><span class="p">,</span> <span class="n">class_mappings</span><span class="p">):</span>
    <span class="n">test_classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">test_sample</span><span class="p">]</span>
    <span class="n">num_test_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_classes</span><span class="p">)</span>
    <span class="n">test_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">class_mappings</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_classes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">algorithm_predictions</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;The count of test classes is not equal to the count of algorithm predictions!&quot;</span><span class="p">)</span>

    <span class="n">num_correct_predictions</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">actual</span> <span class="o">==</span> <span class="n">predicted</span> <span class="k">for</span> <span class="n">actual</span><span class="p">,</span> <span class="n">predicted</span> 
                                                        <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">test_classes</span><span class="p">,</span> <span class="n">algorithm_predictions</span><span class="p">)])</span>

    <span class="n">wrong_predictions</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A:</span><span class="si">{</span><span class="n">test_labels</span><span class="p">[</span><span class="n">actual</span><span class="p">]</span><span class="si">}</span><span class="s1"> | P:</span><span class="si">{</span><span class="n">test_labels</span><span class="p">[</span><span class="n">predicted</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
                                                            <span class="k">for</span> <span class="n">actual</span><span class="p">,</span> <span class="n">predicted</span> 
                                                            <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">test_classes</span><span class="p">,</span> <span class="n">algorithm_predictions</span><span class="p">)</span>
                                                            <span class="k">if</span> <span class="n">actual</span> <span class="o">!=</span> <span class="n">predicted</span><span class="p">]</span>
                        
    <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_correct_predictions</span> <span class="o">/</span> <span class="n">num_test_classes</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">return</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">wrong_predictions</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Evaluate-Algorithm">Evaluate Algorithm<a class="anchor-link" href="#Evaluate-Algorithm"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Due to the different manners in which Test/Train Split &amp; Cross Validation Split divide the dataset, we will create two separate functions for the final algorithm evaluation:</p>
<ol>
<li><p><code>tts_Evaluate_kNN_Algorithm</code>: kNN algorithm evaluation using the Test/Train Split method; and</p>
</li>
<li><p><code>cvs_Evaluate_kNN_Algorithm</code>: kNN algorithm evaluation using the Cross Validation Split method.</p>
</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">tts_Evaluate_kNN_Algorithm</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">class_mappings</span><span class="p">,</span> <span class="n">test_ratio</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> 
                                                                <span class="n">num_neighbours</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">num_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    
    <span class="n">ACCURACY_HISTORY</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">WRONG_PREDICTION_HISTORY</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">_iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iterations</span><span class="p">):</span>
        <span class="n">_dataset</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="n">test_sample</span><span class="p">,</span> <span class="n">train_sample</span> <span class="o">=</span> <span class="n">_test_train_split</span><span class="p">(</span><span class="n">_dataset</span><span class="p">,</span> <span class="n">test_ratio</span><span class="p">)</span>

        <span class="n">algorithm_predictions</span> <span class="o">=</span> <span class="n">kNN_Algorithm</span><span class="p">(</span><span class="n">test_sample</span><span class="p">,</span> <span class="n">train_sample</span><span class="p">,</span> <span class="n">num_neighbours</span><span class="p">)</span>
        <span class="n">accuracy</span><span class="p">,</span> <span class="n">wrong_predictions</span> <span class="o">=</span> <span class="n">_get_accuracy</span><span class="p">(</span><span class="n">test_sample</span><span class="p">,</span> <span class="n">algorithm_predictions</span><span class="p">,</span> <span class="n">class_mappings</span><span class="p">)</span>
        <span class="n">ACCURACY_HISTORY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
        <span class="n">WRONG_PREDICTION_HISTORY</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">wrong_predictions</span><span class="p">)</span>

    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">WRONG_PREDICTION_HISTORY</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kNN algorithm evaluation using the Test/Train Split method:&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Average Accuracy:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ACCURACY_HISTORY</span><span class="p">),</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Maximum Accuracy:&#39;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">ACCURACY_HISTORY</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A: Actual | P: Predicted&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">WRONG_PREDICTION_HISTORY</span><span class="p">[:</span><span class="mi">20</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="p">,</span> <span class="n">class_mappings</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="s2">&quot;ipynb_data/IrisData.csv&quot;</span><span class="p">)</span>
<span class="n">tts_Evaluate_kNN_Algorithm</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">class_mappings</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>kNN algorithm evaluation using the Test/Train Split method: 
	 Average Accuracy: 94.8649 
	 Maximum Accuracy: 100.0 

A: Actual | P: Predicted
A:Iris-versicolor | P:Iris-virginica
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-versicolor | P:Iris-virginica
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-versicolor | P:Iris-virginica
A:Iris-versicolor | P:Iris-virginica
A:Iris-versicolor | P:Iris-virginica
A:Iris-versicolor | P:Iris-virginica
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
</pre>
</div>
</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br /></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cvs_Evaluate_kNN_Algorithm</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">class_mappings</span><span class="p">,</span> <span class="n">num_groups</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
                                                                <span class="n">num_neighbours</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">num_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    
    <span class="n">ACCURACY_HISTORY</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">WRONG_PREDICTION_HISTORY</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">_iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iterations</span><span class="p">):</span>
        <span class="n">_dataset</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="n">dataset_groups</span> <span class="o">=</span> <span class="n">_cross_validation_split</span><span class="p">(</span><span class="n">_dataset</span><span class="p">,</span> <span class="n">num_groups</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset_groups</span><span class="p">):</span>
            <span class="n">test_sample</span> <span class="o">=</span> <span class="n">group</span>
            <span class="n">_train_sample</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">dataset_groups</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">_train_sample</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            
            <span class="n">train_sample</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">train_group</span> <span class="ow">in</span> <span class="n">_train_sample</span><span class="p">:</span>
                <span class="n">train_sample</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">train_group</span><span class="p">)</span>

            <span class="n">algorithm_predictions</span> <span class="o">=</span> <span class="n">kNN_Algorithm</span><span class="p">(</span><span class="n">test_sample</span><span class="p">,</span> <span class="n">train_sample</span><span class="p">,</span> <span class="n">num_neighbours</span><span class="p">)</span>
            <span class="n">accuracy</span><span class="p">,</span> <span class="n">wrong_predictions</span> <span class="o">=</span> <span class="n">_get_accuracy</span><span class="p">(</span><span class="n">test_sample</span><span class="p">,</span> <span class="n">algorithm_predictions</span><span class="p">,</span> <span class="n">class_mappings</span><span class="p">)</span>
            <span class="n">ACCURACY_HISTORY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
            <span class="n">WRONG_PREDICTION_HISTORY</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">wrong_predictions</span><span class="p">)</span>

    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">WRONG_PREDICTION_HISTORY</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kNN algorithm evaluation using the Cross Validation Split method:&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Average Accuracy:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ACCURACY_HISTORY</span><span class="p">),</span> <span class="n">ndigits</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="p">,</span> 
                <span class="s1">&#39;Maximum Accuracy:&#39;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">ACCURACY_HISTORY</span><span class="p">),</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A: Actual | P: Predicted&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">WRONG_PREDICTION_HISTORY</span><span class="p">[:</span><span class="mi">20</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="p">,</span> <span class="n">class_mappings</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="s2">&quot;ipynb_data/IrisData.csv&quot;</span><span class="p">)</span>
<span class="n">cvs_Evaluate_kNN_Algorithm</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">class_mappings</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>kNN algorithm evaluation using the Cross Validation Split method: 
	 Average Accuracy: 95.22 
	 Maximum Accuracy: 100.0 

A: Actual | P: Predicted
A:Iris-virginica | P:Iris-versicolor
A:Iris-versicolor | P:Iris-virginica
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-versicolor | P:Iris-virginica
A:Iris-versicolor | P:Iris-virginica
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-versicolor | P:Iris-virginica
A:Iris-virginica | P:Iris-versicolor
A:Iris-versicolor | P:Iris-virginica
A:Iris-versicolor | P:Iris-virginica
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-virginica | P:Iris-versicolor
A:Iris-versicolor | P:Iris-virginica
A:Iris-versicolor | P:Iris-virginica
A:Iris-virginica | P:Iris-versicolor
</pre>
</div>
</div>

</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discussion">Discussion<a class="anchor-link" href="#Discussion"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the kNN algorithm evaluation using the Cross Validation Split and Test/Train Split method give similar results: <strong>maximum accuracy of 100%</strong> and an <strong>average accuracy of ~95%</strong> across <strong>100 iterations</strong> using <strong>k=3 neighbours</strong>.</p>
<p>A closer look at the randomly printed wrong classifications shows that the algorithm only has porblems differentiating between <code>Iris-virginica</code> and <code>Iris-versicolor</code>. It has no problem correctly classifying <code>Iris-setosa</code>.</p>
<blockquote><p>Recall:<strong> Class Mappings = {'Iris-setosa': 0, 'Iris-versicolor': 1, 'Iris-virginica': 2} </strong></p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This confirms the statement in the Iris Dataset description that:</p>
<blockquote><p>"<strong>One class (specie) is linearly separable from the other 2; the latter are NOT linearly separable from each other...</strong>"</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><div class="flash">
    <svg class="octicon octicon-info" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>The raw notebook file for this post [<code>k-Nearest Neighbours From Scratch</code>] can be found <a href="https://github.com/Outsiders17711/Mein.Platz/blob/main/_notebooks/ipynb_data/kNN-Linear-Regression-Iris_Dataset.ipynb">here</a>.
</div>
<br /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Linear-Regression-From-Scratch">Linear Regression From Scratch<a class="anchor-link" href="#Linear-Regression-From-Scratch"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This will be the end of this post. I will create a separate post for <strong>Linear Regression From Scratch</strong> and link it here.</p>
<p>Thank you.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Resources-&amp;-References">Resources &amp; References<a class="anchor-link" href="#Resources-&amp;-References"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p><a href="https://docs.python.org/3/library/random.html">random — Generate pseudo-random numbers</a></p>
</li>
<li><p><a href="https://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/">Develop k-Nearest Neighbors in Python From Scratch - Machine Learning Mastery</a></p>
</li>
<li><p><a href="https://www.youtube.com/watch?v=uclqpQe8TMQ">K Nearest Neighbors Algorithm using Python From Absolute Scratch - The Nerdy Dev</a></p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><div class="flash flash-success">
    <svg class="octicon octicon-checklist" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M2.5 1.75a.25.25 0 01.25-.25h8.5a.25.25 0 01.25.25v7.736a.75.75 0 101.5 0V1.75A1.75 1.75 0 0011.25 0h-8.5A1.75 1.75 0 001 1.75v11.5c0 .966.784 1.75 1.75 1.75h3.17a.75.75 0 000-1.5H2.75a.25.25 0 01-.25-.25V1.75zM4.75 4a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-4.5zM4 7.75A.75.75 0 014.75 7h2a.75.75 0 010 1.5h-2A.75.75 0 014 7.75zm11.774 3.537a.75.75 0 00-1.048-1.074L10.7 14.145 9.281 12.72a.75.75 0 00-1.062 1.058l1.943 1.95a.75.75 0 001.055.008l4.557-4.45z"></path></svg>
    <strong>Tip: </strong><strong><a href="#kNN-&amp;-Linear-Regression-From-Scratch:-Iris-Dataset">Jump To Top</a></strong>
</div></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
</div>

